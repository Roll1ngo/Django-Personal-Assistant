<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Files</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  {% load static %}
  <link rel="stylesheet" href="{% static 'files/style.css' %}">

</head>
<body>

<div class="container">
  <h1>File List</h1>
  <h2>Upload a file</h2>
  <div class="col-md-4 d-flex align-items-center justify-content-end">
	<a href="{% url 'files:upload_file' %}" class="btn btn-light me-2">Upload</a>
	<a href="{% url 'users:index' %}" class="btn btn-light me-2">Main</a>
	<a href="/files/listfiles" class="btn btn-light me-2">Files</a>
  </div>

  <h2>Documents</h2>
  <ul>
	{% for title, id in documents.items %}
	<li>
	  <span>{{ title }}</span>
	  <div class="dropdown mt-2">
		<button class="btn btn-default dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
		  Options
		</button>
		<ul class="dropdown-menu">
		  <li><a class="dropdown-item" href="{% url 'files:open_file' id %}" target="_blank">Open</a></li>
		  <li><a class="dropdown-item" href="{% url 'files:download_file' id %}" target="_blank">Download</a></li>
		  <li><a class="dropdown-item" href="#" onclick="openDeleteModal()">Delete</a></li>
		</ul>
	  </div>

	</li>
	{% endfor %}
  </ul>

  <h2>Videos</h2>
  <ul>
	{% for title, id in videos.items %}
	<li>
	  <span>{{ title }}</span>
	  <div class="dropdown mt-2">
		<button class="btn btn-default dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
		  Options
		</button>
		<ul class="dropdown-menu">
		  <li><a class="dropdown-item" href="{% url 'files:open_file' id %}" target="_blank">Open</a></li>
		  <li><a class="dropdown-item" href="{% url 'files:download_file' id %}" target="_blank">Download</a></li>
		  <li><a class="dropdown-item" href="#" onclick="openDeleteModal()">Delete</a></li>
		</ul>
	  </div>
	  <div class="modal fade" id="myModal" role="dialog">
		<div class="modal-dialog modal-sm">
		  <div class="modal-content">
			<div class="modal-body">
			  <p>File will be deleted. Are you sure?</p>
			</div>
			<div class="modal-footer">
			  <form id="deleteForm" method="post" action="{% url 'files:delete_file' id %}">
				{% csrf_token %}
				<button id="confirmDelete" type="submit" class="btn btn-danger">Yes</button>
				<button type="button" class="btn btn-default" onclick="closeModal()">Cancel</button>
			  </form>
			</div>
		  </div>
		</div>
	  </div>
	</li>
	{% endfor %}
  </ul>

  <h2>Images</h2>
  <ul>
	{% for title, id in images.items %}
	<li>
	  <span>{{ title }}</span>
	  <div class="link-actions">
		<a href="{% url 'files:open_file' id %}" target="_blank">Open</a>
		<a href="{% url 'files:download_file' id %}" target="_blank">Download</a>
		<a href="{% url 'files:delete_file' id %}">Delete</a>
	  </div>
	</li>
	{% endfor %}
  </ul>

  <h2>Other</h2>
  <ul>
	{% for title, id in other.items %}
	<li>
	  <span>{{ title }}</span>
	  <div class="dropdown mt-2">
		<button class="btn btn-default dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
		  Actions
		</button>
		<ul class="dropdown-menu">
		  <li><a class="dropdown-item" href="{% url 'files:open_file' id %}">Open</a></li>
		  <li><a class="dropdown-item" href="{% url 'files:download_file' id %}">Download</a></li>
		  <li><a class="dropdown-item" href="" onclick="openDeleteModal()">Delete</a></li>
		</ul>
	  </div>


	  {% endfor %}
  </ul>
</div>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  var dropdownElementList = [].slice.call(document.querySelectorAll('.dropdown-toggle'))
  var dropdownList = dropdownElementList.map(function (dropdownToggleEl) {
	  return new bootstrap.Dropdown(dropdownToggleEl)
  });
</script>
<script>
  $(document).ready(function(){
	  $("#myInput").on("keyup", function() {
		  var value = $(this).val().toLowerCase();
		  $(".card-body").filter(function() {
			  $(this).parent().parent().toggle($(this).text().toLowerCase().indexOf(value) > -1)
		  });
	  });
  });
</script>
<script>
  function openDeleteModal() {
	  $('#myModal').modal('show');
  }
</script>
<script>
  function closeModal() {
	  $('#myModal').modal('hide');
	  }
</script>
</body>
</html>